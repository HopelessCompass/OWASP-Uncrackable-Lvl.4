# OWASP-Uncrackable-Lvl.4
Reverse Engineering Journal — OWASP Uncrackable Lvl.4 (Android, Native, Smali)

Я не супер-профи, но упорно ковыряюсь и учусь. Это журнал всей работы, чтобы самой понимать путь, и чтобы другие новички могли видеть, что всё реально

## I. Исходная задача
Разобрать и пропатчить Android-приложение OWASP Uncrackable Level 4, которое:
1. Использует RootBeer для анти-рут детекции
2. Вызывает нативную функцию gXftm3iswpkVgBNDUp(...) из libnative-lib.so
3. Проверяет введённый PIN и сумму
4, Собирает их в буфер → шифрует/кодирует → выдаёт r2coin-токен
5. Валидность токена определяется цветом и первым байтом ответа

## II. Обход защит от взлома (проверка на рута)
Найдена логика root-чеков в Smali в методе
```
.method public j()Z
```
который вызывает цепочку проверок:
h() - опасные пакеты
g() - опасные приложения
a("su") — поиск бинаря su
b() — опасные props
d() — монтирования в режиме RW
i() — test-keys
f() — which su
e() — native RootBeer
c() — "magisk"

Пропатчено в Smali (полностью заменено содержимое):
```
.method public j()Z
    .locals 1

    const/4 v0, 0x0
    return v0

.end method
```

Это гарантирует, что приложение всегда будет думать утройство не рутовано

## III. Почему оно всё равно падало (важный вывод)
Фейл был не в патче j(). В оригинальной Java-логике есть ловушка:
```
if (rb.m2456j() || (rb.m2441a() && rb.m2451e())) {
    int i = 1337 / 0;   // <-- явное падение
    this.f2369a = (byte) (this.f2369a | 15);
}
```
Если RootBeer обнаруживает root раньше — приложение крашится до вызова твоего пропатченного j().

# TBC
